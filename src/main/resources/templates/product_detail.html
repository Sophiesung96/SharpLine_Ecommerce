<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
     >
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
    <title>Product_detail</title>
    <link rel="icon" type="image/x-icon"th:href="@{/image/logo.png}">
    <!-- Latest compiled and minified CSS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <!-- Latest compiled JavaScript -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
</head>
<body>
<div class="container">
    <div class="row">
        <div class="navbar navbar-expand-lg bg-dark navbar-dark">
            <a class="navbar-brand" th:href="@{/home}">
                <img th:src="@{/image/logo.png}" style="width:100px;height:50px">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarToggleExternalContent">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/users/1}">Careers</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/categories/1}">Payments</a>
                    </li>


                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/brands/1}">Shipping &amp; Delivery</a>
                    </li>



                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/products/1}">Login</a>
                    </li>


                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/questions}">Register</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/customers}">Contact</a>
                    </li>
                </ul>


            </div>

        </div>

    </div>

    <div class="row">
        <div class="col-md">
            <th:block sec:authorize="isAuthenticated()">
                <form th:action="@{/logout}" method="post" th:hidden="true" name="LogoutForm">
                    <input type="submit" value="Logout">
                </form>
            </th:block>

            <nav class="navbar navbar-expand-sm bg-light">
                <div class="collapse navbar-collapse d-flex align-items-center" id="searchNavBar">
                    <form th:action="@{/search}" method="get" class="d-flex">
                        <input type="search" name="keyword" class="form-control ms-auto"
                               th:value="${keyword}" placeholder="keyword" required>
                        <input type="submit" value="Search" class="btn btn-outline-success"/>
                    </form>
                    <ul class="navbar-nav" >
                        <!--the following section is only accessible if the user is authenticated-->
                        <th:block sec:authorize="isAuthenticated()">
                            <th:block th:with="userPrincipal=${#httpServletRequest.userPrincipal}">
                                <th:block th:if="${userPrincipal != null and userPrincipal.name != null}">
                                    <li class="nav-item">
                                        <b><a class="nav-link" th:href="@{/account_details}" th:text="${userPrincipal.name}"></a></b>
                                    </li>
                                </th:block>
                            </th:block>





                            <li class="nav-item">
                                <a class="nav-link" href="">Addresses</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="">Questions</a>
                            </li>


                            <li class="nav-item">
                                <a class="nav-link" href="">Reviews</a>
                            </li>



                            <li class="nav-item">
                                <a class="nav-link" href="">Orders</a>
                            </li>


                            <li class="nav-item">
                                <a class="nav-link" th:href="@{/cart}" style="font-weight: bold">
                                    <i class="fa-solid fa-2x fa-cart-shopping"></i>
                                    Cart
                                </a>

                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="javascript:document.LogoutForm.submit()">
                                    Logout
                                </a>
                            </li>

                        </th:block>


                    </ul>
                </div>
            </nav>
        </div>
    </div>


    <div class="row">
        <div class="col-md">
            <nav class="navbar navbar-expand-sm bg-light">
                <div class="collapse navbar-collapse" id="searchNavbar">
                    <div class="input-group-sm" style="width:35%">
                        <form class="d-flex" method="get" th:action="@{'/p'+'/'+${product.alias}+'/'+${pageno}+'/keyword'}">
                            <input class="form-control me-1" type="search" placeholder="Search" name="keyword">
                            <button class="btn btn-success" type="submit">Search</button>
                        </form>
                    </div>



                </div>
            </nav>
        </div>
    </div>

  <div th:replace="~{breadcrumb ::content}"></div>



    <div class="row">
        <div class="col-sm">
            <div>
                <img id="bigImg" th:src="@{${product.getMainImagePath()}}" class="img-fluid" index="0">
            </div>

            <div class="row justify-content-center mt-2">
                <div class="col-2  border border-secondary p-1 m-2">
                    <img class="image-thumbnail" th:src="@{${product.getMainImagePath()}}" height="40" index="0"/>
                </div>
                <th:block th:each="extra,status:${extraList}">
                    <div class=" col-2  border border-secondary m-2 p-1">
                        <img th:src="@{${extra.getImagePath()}}" class="image-thumbnail" height="40" th:index="${status.count}"/>
                    </div>
                </th:block>
            </div>
        </div>

        <div class="col-sm">
            <h2 class="text-info ">[[${product.name}]]</h2>

            <div>
                <span>Brand: [[${productCBName.BrandName}]]</span>
            </div>
            <div>
                List Price:
                     <span th:if="${product.discountPercent<=0}">
                     <span th:if="${CURRENCY_SYMBOL_POSITION} == 'Before_Price'">[[${CURRENCY_SYMBOL}]]</span>

                      [[${product.price}]]
                       <span th:if="${CURRENCY_SYMBOL_POSITION} == 'After_Price'">[[${CURRENCY_SYMBOL}]]</span>

                    </span>
                    <del th:if="${product.discountPercent>0}" >
                       <span>
                      <span th:if="${CURRENCY_SYMBOL_POSITION} == 'Before_Price'">[[${CURRENCY_SYMBOL}]]</span>
                         [[${product.price}]]
                     <span th:if="${CURRENCY_SYMBOL_POSITION} == 'After_Price'">[[${CURRENCY_SYMBOL}]]</span>
                    </span>

                    </del>
            </div>
            <div th:if="${product.discountPercent>0}" >
                Price:
                <span style="font-size: larger ;color: darkred;">
                    <span th:if="${CURRENCY_SYMBOL_POSITION} == 'Before_Price'" >[[${CURRENCY_SYMBOL}]]</span>
                     [[${product.getDetailPrice()}]]
                    <span th:if="${CURRENCY_SYMBOL_POSITION} == 'After_Price'">[[${CURRENCY_SYMBOL}]]</span>
                </span>
                ([[${product.discountPercent}]] % off)
             </div>

             <div th:utext="${product.shortDescription}"></div>
         </div>

         <div class="col-sm-2">
             <div>
                 <span th:if="${product.inStock}==1" class="text-success"><b>In Stock</b></span>
                 <span th:if="${product.inStock}==0" style="font-size: larger ;color: darkred;"><b>Out Of Stock</b></span>
             </div>
             <th:block th:if="${product.inStock}==1">
                 <div class="mt-2">
                     <div th:replace="~{Quantity_Control::quantity_control(1, ${product.id})}"></div>

                 </div>
                 <div class="mt-3">
                     <input type="button"  value="Add to Cart" id="buttonAdd2Cart" class="btn btn-primary">
                 </div>
             </th:block>


         </div>
     </div>

     <div class="row">
         <div class="col-12">
             <div><hr/></div>
             <div>
                 <h4>Product Description:</h4>
             </div>
             <div th:utext="${product.fullContent}"></div>
         </div>
     </div>
     <div class="row">
         <div class="col-12">
             <div><hr/></div>
             <div>
                 <h4>Product Details:</h4>
             </div>
             <th:block th:each="detail:${detailList}">
                 <div>
                     <b>[[${detail.name}]]</b>:
                     <span>[[${detail.value}]]</span>
                 </div>

             </th:block>
         </div>
     </div>

     <div class="row mt-2">
         <div class="navbar navbar-expand-lg bg-dark navbar-dark">

             <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                     data-bs-target="#navbarFooter">
                 <span class="navbar-toggler-icon"></span>
             </button>
             <div class="collapse navbar-collapse" id="navbarFooter">
                 <ul class="navbar-nav">
                     <li class="nav-item">
                         <a class="nav-link" th:href="@{/users/1}">About Us</a>
                     </li>

                     <li class="nav-item">
                         <a class="nav-link" th:href="@{/categories/1}">Privacy Notice</a>
                     </li>


                     <li class="nav-item">
                         <a class="nav-link" th:href="@{/brands/1}">Returns &amp; Refunds</a>
                     </li>


                 </ul>


             </div>
         </div>
     </div>

 </div>






     <nav>
         <ul class="pagination justify-content-center">
             <li class="page-item"><a class="page-link" th:href="@{'/p/'+${nickname}+'/'+1}">First</a></li>
             <li class="page-item"><a class="page-link" th:href="@{'/p/'+${nickname}+'/'+${currentpage -1}}">Previous</a>
             </li>
             <th:block th:each="num:${pagelist}">

                 <li class="page-item"><a class="page-link" th:href="@{'/p/'+${nickname}+'/'+${num}}"
                                          th:text="${num}">1</a></li>
             </th:block>
             <li class="page-item"><a class="page-link" th:href="@{'/p/'+${nickname}+'/'+${currentpage+1}}">Next</a>
             </li>
         </ul>
     </nav>
     <div th:replace="~{image_carousel ::content}"></div>


 <script type="text/javascript">
     $(document).ready(function () {
         ProductId="[[${product.id}]]"
         bigImage=$('#bigImg');
         $(".image-thumbnail").mouseover(function () {
             currentImage=$(this).attr("src");
             currentImageIndex=$(this).attr("index");
            bigImage.attr("src",currentImage);
             bigImage.attr("index",currentImageIndex);
         });
         bigImage.on("click",function () {
             var modal = new bootstrap.Modal(document.getElementById('carouselModal'));
             modal.show();
             var myCarousel = document.getElementById('carouselExampleIndicators');
             var carousel = new bootstrap.Carousel(myCarousel);
             img=parseInt(bigImage.attr("index"));
             // Slide to the specified index
             carousel.to(img);
         })

     })
 </script>
 <script type="text/javascript" th:src="@{/Js/QuantityControl.js}"></script>
<script type="text/javascript" th:src="@{/Js/Shopping_Cart.js}"></script>

 </body>
 </html>